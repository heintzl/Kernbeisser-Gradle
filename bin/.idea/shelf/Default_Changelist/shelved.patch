Index: src/main/java/kernbeisser/Reports/UserBalanceReport.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package kernbeisser.Reports;\r\n\r\nimport java.sql.Timestamp;\r\nimport java.time.Instant;\r\nimport java.time.temporal.ChronoUnit;\r\nimport java.util.Collection;\r\nimport java.util.List;\r\nimport java.util.Map;\r\nimport java.util.stream.Collectors;\r\nimport kernbeisser.DBEntities.UserGroup;\r\n\r\npublic class UserBalanceReport extends Report {\r\n  final Timestamp timeStamp;\r\n  private final boolean withNames;\r\n  private List<UserGroup> userGroups;\r\n  private final long reportNo;\r\n\r\n  public UserBalanceReport(long reportNo, boolean withNames) {\r\n    super(\r\n        \"userBalanceFileName\",\r\n        String.format(\r\n            \"KernbeisserGuthabenst채nde_%s\",\r\n            Timestamp.from(Instant.now().truncatedTo(ChronoUnit.MINUTES)).toString()));\r\n    this.reportNo = reportNo;\r\n    this.withNames = withNames;\r\n    this.timeStamp = Timestamp.from(Instant.now().truncatedTo(ChronoUnit.MINUTES));\r\n    this.userGroups = getUserGroups();\r\n  }\r\n\r\n  private List<UserGroup> getUserGroups() {\r\n    return UserGroup.getActiveUserGroups().stream()\r\n        .map(ug -> ug.withMembersAsStyledString(this.withNames))\r\n        .sorted((u1, u2) -> u1.getMembersAsString().compareToIgnoreCase(u2.getMembersAsString()))\r\n        .collect(Collectors.toList());\r\n  }\r\n\r\n  @Override\r\n  Map<String, Object> getReportParams() {\r\n    Map<String, Object> params = UserGroup.getValueAggregates();\r\n    params.put(\r\n        \"reportTitle\",\r\n        \"Guthabenst채nde\" + (reportNo == 0 ? \"\" : \" zu LD-Endabrechnung Nr. \" + reportNo));\r\n    return params;\r\n  }\r\n\r\n  @Override\r\n  Collection<?> getDetailCollection() {\r\n    return userGroups;\r\n  }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/kernbeisser/Reports/UserBalanceReport.java b/src/main/java/kernbeisser/Reports/UserBalanceReport.java
--- a/src/main/java/kernbeisser/Reports/UserBalanceReport.java	(revision c503879f0d686b5b656088372daca740eb0070c9)
+++ b/src/main/java/kernbeisser/Reports/UserBalanceReport.java	(date 1647197940000)
@@ -28,7 +28,13 @@
   }
 
   private List<UserGroup> getUserGroups() {
-    return UserGroup.getActiveUserGroups().stream()
+    List<UserGroup> userGroups;
+    if (reportNo == -1) {
+      userGroups = UserGroup.getActiveUserGroups();
+      } else {
+      userGroups = UserGroup.getHistoricUserGroups(reportNo);
+    }
+    return userGroups.stream()
         .map(ug -> ug.withMembersAsStyledString(this.withNames))
         .sorted((u1, u2) -> u1.getMembersAsString().compareToIgnoreCase(u2.getMembersAsString()))
         .collect(Collectors.toList());
@@ -39,7 +45,7 @@
     Map<String, Object> params = UserGroup.getValueAggregates();
     params.put(
         "reportTitle",
-        "Guthabenst채nde" + (reportNo == 0 ? "" : " zu LD-Endabrechnung Nr. " + reportNo));
+        "Guthabenst채nde" + (reportNo == -1 ? "" : " zu LD-Endabrechnung Nr. " + reportNo));
     return params;
   }
 
